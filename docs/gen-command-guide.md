# !젠 명령어 가이드

## 개요
`!젠` 명령어는 다음 젠타임(리젠 예정 시간)을 입력받아 역산으로 컷타임을 계산하는 기능입니다. 시간마다 리젠되는 보스에만 사용할 수 있습니다.

## 기본 사용법

### 지원 형식
- `!젠 <보스명> HHMM`: 오늘 해당 시간에 젠
- `!젠 <보스명> MMDDHHMM`: 해당 월일시간에 젠

### 사용 예시
```
!젠 데스나이트 1430
→ 오늘 14:30에 젠되도록 컷타임 역산

!젝 베나투스 09211230
→ 9월 21일 12:30에 젠되도록 컷타임 역산
```

## 계산 로직

### 역산 공식
```
젠타임 - 리젠시간 = 컷타임
```

### 예시 계산
- 보스: 데스나이트 (3시간마다 리젠)
- 젠타임: 2025-09-21 14:30
- 계산: 14:30 - 3시간 = 11:30
- 결과 컷타임: 2025-09-21 11:30:00

## 제한사항

### 보스 유형 제한
- ✅ **시간마다** 리젠 보스: 사용 가능
- ❌ **특정요일** 리젠 보스: 사용 불가

### 권한 요구사항
- 구글 시트에 등록된 사용자만 사용 가능
- 일반길드원 이상 권한 필요

## 성공 응답 예시
```
✅ '데스나이트' 젠타임 기반 컷타임 설정 완료!
🎯 젠타임: 09월 21일 14:30
⏰ 컷타임: 2025-09-21 11:30:00
📊 리젠시간: 3시간마다
```

## 오류 메시지

### 일반적인 오류
- `❌ 보스명을 입력해주세요.`
- `❌ 젠타임을 입력해주세요.`
- `❌ 존재하지 않는 보스입니다.`
- `❌ 시트에 등록되지 않은 사용자입니다.`

### 보스 유형 오류
```
❌ '보스명'은(는) 시간마다 리젠되는 보스가 아닙니다.
현재 리젠타입: 특정요일

💡 젠 명령어는 시간마다 리젠되는 보스만 지원됩니다.
```

### 시간 형식 오류
- `❌ 젠타임은 숫자만 입력해주세요. (HHMM 또는 MMDDHHMM)`
- `❌ 시간은 00-23 사이로 입력해주세요.`
- `❌ 분은 00-59 사이로 입력해주세요.`
- `❌ 월은 01-12 사이로 입력해주세요.`
- `❌ 일은 01-31 사이로 입력해주세요.`
- `❌ 젠타임 형식이 올바르지 않습니다. (HHMM 또는 MMDDHHMM)`
- `❌ 올바르지 않은 날짜입니다.`

## 기술적 구현

### 핵심 파일
- `/src/commands/text/user/bossGen.js` - 메인 명령어 파일
- `/src/utils/timeCalculator.js` - 공통 시간 계산 유틸리티

### 확장성 설계
`timeCalculator.js`의 공통 함수들은 향후 `!점검` 명령어에서도 재사용 가능하도록 설계:

```javascript
// 공통 함수들
parseTimeArgument(timeArg)          // 시간 파싱
calculateCutTimeFromGen(genTime, regenSettings)  // 젠타임 → 컷타임 역산
calculateCutTimeFromMaintenance(maintenanceTime, regenSettings)  // 점검 → 컷타임
isHourlyRegenBoss(regenType)        // 시간마다 리젠 보스 판별
formatDateTime(date)                // 데이터베이스용 시간 포맷
formatDisplayTime(date)             // 사용자 표시용 시간 포맷
```

### 향후 점검 명령어 확장 예시
```
!점검 1400
→ 14:00 점검 완료 시 모든 시간마다 리젠 보스들의 컷타임을 점검완료시간으로 설정
```

## 테스트 시나리오

### 정상 동작 테스트
1. 시간마다 리젠 보스에 대해 `!젠 보스명 1430` 실행
2. 응답에서 젠타임, 컷타임, 리젠시간 정보 확인
3. 구글 시트에서 컷타임이 올바르게 업데이트 되었는지 확인

### 오류 처리 테스트
1. 특정요일 리젠 보스에 대해 명령어 실행 → 보스 유형 오류 확인
2. 존재하지 않는 보스명으로 실행 → 보스 존재 오류 확인
3. 잘못된 시간 형식으로 실행 → 시간 형식 오류 확인
4. 시트에 등록되지 않은 사용자로 실행 → 권한 오류 확인

### 경계값 테스트
- 시간: 0000, 2359
- 날짜: 0101, 1231, 윤년 0229
- 존재하지 않는 날짜: 0230, 1132

---
*업데이트: 2025-09-21 !젠 명령어 구현 완료*