# 보탐봇 사용 설명서 📋

Discord 보스 타이머 봇의 설정 및 사용 방법을 설명합니다.

## 🚀 초기 설정 가이드

### 1. 환경변수 설정 (.env 파일)
```bash
# Discord 봇 설정
DISCORD_TOKEN=봇의_토큰
GUILD_ID=디스코드_서버_ID
COMMAND_PREFIX=!

# Google Sheets 설정
GOOGLE_SHEET_ID=스프레드시트_ID
GOOGLE_SERVICE_ACCOUNT_PATH=./service-account-key.json
```

### 2. Google Sheets 준비
1. Google Sheets에서 새 스프레드시트 생성
2. 서비스 계정 키 파일을 프로젝트 루트에 저장 (`service-account-key.json`)
3. 스프레드시트를 서비스 계정 이메일과 공유 (편집 권한)
4. `!시트생성` 명령어로 봇 전용 시트 생성

### 3. 봇 시작
```bash
npm start
```

---

## 👥 권한 관리

### 권한 종류 (3단계)
| 권한 | 설명 | 색상 | 아이콘 |
|------|------|------|--------|
| **관리자** | 모든 시트 관리 명령어 사용 가능 | 🔴 빨강 | 👑 |
| **운영진** | 보스 관리 명령어 사용 가능 (추후 추가) | 🟠 주황 | ⭐ |
| **일반길드원** | 기본 사용자 명령어만 사용 가능 | 🔵 청록 | 👤 |

### 권한 설정 방법
Google Sheets의 `보탐봇-길드원정보` 시트에서 관리:

1. 시트를 열고 사용자 추가
2. 권한 컬럼에서 **드롭다운**을 클릭하여 선택:
   - `관리자` 👑
   - `운영진` ⭐ 
   - `일반길드원` 👤

**예시:**
```
사용자ID        | 닉네임 | 총점수 | 권한        | 가입일시
123456789      | 홍길동 | 100    | 관리자 ▼   | 2024-01-01 09:00:00
987654321      | 김철수 | 50     | 운영진 ▼   | 2024-01-01 10:00:00
111222333      | 박영희 | 10     | 일반길드원▼ | 2024-01-01 11:00:00
```

✅ **드롭다운 장점:**
- **오타 방지**: 정확한 권한명만 선택 가능
- **입력 편의성**: 드롭다운에서 클릭만 하면 됨
- **일관성**: 모든 사용자가 동일한 권한명 사용

⚠️ **주의사항:**
- 봇이 시트를 생성한 후 자동으로 드롭다운이 설정됩니다
- 시트에 등록되지 않은 사용자는 명령어 사용 불가
- Discord 서버 관리자 권한과는 별개로 동작

💡 **드롭다운이 안 보인다면:**
1. `!시트생성` 명령어를 다시 실행해보세요
2. 시트를 새로고침해보세요
3. 권한 컬럼(D열)을 클릭하면 드롭다운이 나타납니다

---

## 🎮 명령어 목록

### 일반 사용자 명령어
| 명령어 | 별칭 | 설명 |
|--------|------|------|
| `!명령어` | `!help` | 사용 가능한 명령어 목록 확인 |
| `!내정보` | `!정보확인` | 개인 정보 확인 (권한, 점수 등) |
| `!보스일정` | `!bossschedule` | 보스 리젠 일정 확인 |
| `!컷` | `!cut` | 보스 컷타임 등록 (!컷, !컷 HHMM, !컷 MMDDHHMM) |
| `!ping` | `!핑`, `!pong` | 봇 응답 시간 확인 |

### 관리자 전용 명령어
| 명령어 | 별칭 | 설명 | 필요 권한 |
|--------|------|------|-----------|
| `!시트연결확인` | - | Google Sheets 연결 상태 확인 | 관리자 |
| `!시트생성` | - | 봇 전용 시트 생성 | 관리자 |
| `!시트동기화` | - | 기존 시트를 최신 구조로 업데이트 | 관리자 |

### 운영진 이상 명령어
| 명령어 | 별칭 | 설명 | 필요 권한 |
|--------|------|------|-----------|
| `!보스추가` | `!보스등록` | 새로운 보스 등록 (모달 인터페이스) | 운영진 |

---

## 📊 Google Sheets 구조

봇이 생성하는 시트들:

### 1. 보탐봇-보스정보
보스 데이터 저장
```
보스명 | 점수 | 스케줄타입 | 스케줄정보 | 생성일시
```

### 2. 보탐봇-길드원정보  
길드원 권한 및 점수 관리 ⭐ **가장 중요**
```
사용자ID | 닉네임 | 총점수 | 권한 | 가입일시
```

### 3. 보탐봇-참여이력
보스 참여 기록
```
참여일시 | 사용자ID | 보스명 | 획득점수
```

### 4. 보탐봇-루팅이력
아이템 분배 기록
```
루팅일시 | 보스명 | 아이템명 | 획득자 | 분배일시
```

---

## 🔧 문제 해결

### Q: 명령어가 작동하지 않아요
**A:** 다음을 확인하세요:
1. 봇이 온라인 상태인지 확인
2. `!내정보`로 본인의 권한 확인
3. 시트에 본인이 등록되어 있는지 확인
4. 권한명이 정확히 입력되어 있는지 확인

### Q: "권한 부족" 메시지가 나와요
**A:** 관리자에게 시트 권한 설정을 요청하세요.

### Q: Google Sheets 연결이 안 돼요
**A:** 관리자가 다음을 확인해야 합니다:
1. 서비스 계정 키 파일 경로
2. 스프레드시트 공유 설정
3. Google Sheets API 활성화 상태

### Q: 권한 드롭다운이 보이지 않아요
**A:** 다음을 시도해보세요:
1. Discord에서 `!시트생성` 명령어를 다시 실행
2. Google Sheets 페이지 새로고침
3. 권한 컬럼(D열)을 직접 클릭
4. 여전히 안 되면 수동으로 데이터 유효성 검사 설정

### Q: 드롭다운에서 선택했는데 권한이 적용되지 않아요
**A:** 다음을 확인해보세요:
1. 올바른 권한을 선택했는지 확인 (`관리자`, `운영진`, `일반길드원`)
2. 시트 저장 후 잠시 기다린 후 다시 시도
3. `!내정보` 명령어로 현재 권한 상태 확인

### Q: 봇 업데이트 후 시트 구조가 맞지 않아요
**A:** 개발 중 시트 구조 변경이 있을 때:
1. `!시트동기화` 명령어를 실행하세요 (관리자 전용)
2. 기존 데이터는 유지하면서 헤더와 드롭다운이 업데이트됩니다
3. 실시간으로 진행상황을 확인할 수 있습니다

### Q: 시트동기화는 언제 사용하나요?
**A:** 다음 상황에서 사용하세요:
- 봇 업데이트 후 시트 구조가 변경된 경우
- 드롭다운이 제대로 작동하지 않는 경우  
- 새로운 컬럼이 추가된 경우
- 개발자가 시트 구조 업데이트를 안내한 경우

### Q: 점수가 업데이트되지 않아요
**A:** 추후 보스 시스템 구현 후 자동 업데이트됩니다.

---

## 🆕 업데이트 예정 기능

- [ ] 보스 추가/삭제 명령어
- [ ] 보스 스케줄 관리
- [ ] 자동 알림 시스템  
- [ ] 참여도 점수 시스템
- [ ] 루팅 관리 시스템
- [ ] 통계 및 리포트 기능

---

## 📞 지원

문제가 발생하면:
1. 먼저 이 문서의 문제 해결 섹션을 확인
2. 여전히 해결되지 않으면 서버 관리자에게 문의
3. 기술적 문제는 개발자에게 문의

---

*이 문서는 봇 업데이트와 함께 지속적으로 업데이트됩니다. 📝*